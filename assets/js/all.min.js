function ajaxRequest(t,i,a={}){return new Promise(((e,o)=>{$.ajax({url:i,type:t,data:a,success:function(t){e(t)},error:function(t){o(t)}})}))}function applyDataToImg(t,i,a,e){$(i).attr("src",`https://picsum.photos/id/${t.id}/${a}/${e}`),$(i).text("alt",`Image by ${t.author}`)}let maxId=1082;const getRandomID=()=>Math.floor(Math.random()*maxId)+1;export function ajaxToImg(t,i,a,e){ajaxRequest("GET",`https://picsum.photos/id/${t}/info`).then((t=>{applyDataToImg(t,i,a,e)})).catch((t=>{console.log("Error:",t.responseText)}))}export async function randomImg(){let t,i=!1;for(let a=0;a<5;++a){console.log(`Attempt ${a+1} for randomImg()`);let e=Math.floor(Math.random()*maxId)+1;if(await ajaxRequest("GET",`https://picsum.photos/id/${e}/info`).then((a=>{t=a,console.log("Image found:",a.id),i=!0})).catch((t=>{console.log(`Error for ID#${e}: ${t.responseText}`)})),i){applyDataToImg(t,"#picsum-img",400,400);break}}i||($("#picsum-img").attr("src","./assets/img/not-found.jpg"),console.log("Too many attempts, please try again"))}export class MailImg{constructor(t="",i=""){this._mailTo=t,this._idList=[i]}get mailTo(){return this._mailTo}get idList(){return this._idList}set mailTo(t){this._mailTo=t}set idList(t){this._idList=t}addId=t=>this._idList.push(t);removeiD=t=>{this._idList.splice(this.idList.indexOf(t),1)}}let mailList=[];function displayTable(){let t=$("#mail-list .table-group-divider");t.empty(),mailList.forEach((i=>{let a=i.mailTo.replace("@","-").replace(".","-");$(`<tr id="row-${a}">`).prependTo(t);let e=`<td id="email-${a}">${i.mailTo}</td>`;$(e).appendTo($(`#row-${a}`)),$(`<td><ul id="images-${a}"></ul></td>`).appendTo($(`#row-${a}`)),i.idList.forEach((t=>{$(`<img id="image-${t}"></li>`).prependTo($(`#images-${a}`)),ajaxToImg(t,`#image-${t}`,50,50)}))}))}function validateEmail(t){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)}$((function(){randomImg(),$('label[for="user-email"]').hide()})),$("#add-email").on("click",(function(t){t.preventDefault();let i=$("#user-email").val();if(validateEmail(i)){let t=$("#picsum-img").attr("src");t=t.split("/")[4];let a=!1;for(let e=0;e<mailList.length;++e)if(mailList[e].mailTo===i){mailList[e].addId(t),a=!0;break}a||mailList.push(new MailImg(i,t)),displayTable(),randomImg()}else console.log("Bad email:",$("#user-email").val()),$('label[for="user-email"]').show().delay(5e3).hide(),$("#user-email").focus()}));