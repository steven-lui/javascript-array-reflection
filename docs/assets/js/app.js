"use strict";class MailImg{constructor(t="",i=""){this._mailTo=t,this._idList=[i]}get mailTo(){return this._mailTo}get idList(){return this._idList}set mailTo(t){this._mailTo=t}set idList(t){this._idList=t}addId=t=>this._idList.push(t);removeiD=t=>{this._idList.splice(this.idList.indexOf(t),1)}}function ajaxRequest(t,i,a={}){return new Promise(((o,e)=>{$.ajax({url:i,type:t,data:a,success:function(t){o(t)},error:function(t){e(t)}})}))}function applyDataToImg(t,i,a,o){$(i).attr("src",`https://picsum.photos/id/${t.id}/${a}/${o}`),$(i).text("alt",`Image by ${t.author}`)}let maxId=1082;const getRandomID=()=>Math.floor(Math.random()*maxId)+1;function ajaxToImg(t,i,a,o){ajaxRequest("GET",`https://picsum.photos/id/${t}/info`).then((t=>{applyDataToImg(t,i,a,o)})).catch((t=>{console.log("Error:",t.responseText)}))}async function randomImg(){let t,i=!1;for(let a=0;a<5;++a){console.log(`Attempt ${a+1} for randomImg()`);let o=Math.floor(Math.random()*maxId)+1;if(await ajaxRequest("GET",`https://picsum.photos/id/${o}/info`).then((a=>{t=a,console.log("Image found:",a.id),i=!0})).catch((t=>{console.log(`Error for ID#${o}: ${t.responseText}`)})),i){applyDataToImg(t,"#picsum-img",400,400);break}}i||($("#picsum-img").attr("src","./assets/img/not-found.jpg"),console.log("Too many attempts, please try again"))}let mailList=[];function displayTable(){let t=$("#mail-list .table-group-divider");t.empty(),mailList.forEach((i=>{let a=`<tr id="row-${i.mailTo}">`;$(a).prependTo(t);let o=`<td id="email-${i.mailTo}">${i.mailTo}</td>`;$(o).appendTo($(`#row-${i.mailTo}`));let e=`<td><ul id="images-${i.mailTo}"></ul></td>`;$(e).appendTo($(`#row-${i.mailTo}`)),i.idList.forEach((t=>{$(`<img id="image-${t}"></li>`).prependTo($(`#images-${i.mailTo}`)),ajaxToImg(t,`#image-${t}`,50,50)}))}))}function validateEmail(t){return!0}$((function(){randomImg()})),$("#add-email").on("click",(function(t){t.preventDefault();let i=$("#user-email").val();if(validateEmail(i)){let t=$("#picsum-img").attr("src");t=t.split("/")[4];let a=!1;for(let o=0;o<mailList.length;++o)if(mailList[o].mailTo===i){mailList[o].addId(t),a=!0;break}a||mailList.push(new MailImg(i,t)),displayTable(),randomImg()}}));